![banner](/images/banner2.png)

# 腾讯云 COS 图床插件

这是一个用于 Obsidian 的图片上传插件，可将笔记中的图片自动上传到腾讯云 COS，实现云端存储、管理与备份。

<details>
<summary>新增功能 (2026-02-10)</summary>

- 本地和在线笔记备份，备份路径自定义

- 鼠标悬浮图片，支持拖拽图片改图片大小(支持本地和线上图片)

- 图片管理功能，可查看和删除已上传的图片，支持面板和命令方式打开

- 新增设置图片链接的有效期，新增测试连接功能

- 新增是否开启公有读存储桶

> 备份笔记演示

![笔记备份](./images/new-backup.png)

![笔记备份](./images/local-note.gif)

注意：

- 本地笔记备份：这篇笔记的图片都是本地链接还没上传与备份
- 在线笔记备份：这篇笔记的图片都是线上链接还没备份

> 拖拽图片演示

![拖拽图片](./images/drag-image.gif)

> 新增的设置

![设置](./images/settings2.png)

- 备份路径支持自定义，默认当前笔记仓库下

- 新增设置图片链接的有效期 20年,50年,永久

- 测试连接可以调试你配置是否正常

> 设置打开图片管理面板

![图片管理删除](./images/del-image.gif)

> 命令打开图片管理面板

![图片管理删除命令](./images/del-image-command.gif)

> 是否开启公有读存储桶

腾讯云进入 COS 控制台
找到你的存储桶 → 权限管理 → 存储桶访问权限设置

![公有读存储桶](./images/cos-auth.png)

![公有读存储桶](./images/cos-auth2.png)

开启公有读存储桶 图片为短链接如 https://xxx.com/20260210143554.png

建议：如果图片是公开的（如博客配图），可以开启公有读；
如果图片包含隐私内容，保持私有读模式更安全。

</details>

## 功能特点

- 支持拖拽、复制粘贴上传图片
- 自动替换本地图片链接为云端链接
- 支持图片悬浮拖拽调整大小（本地与线上图片均支持）
- 支持本地笔记备份与在线笔记备份，且备份路径可自定义
- 支持图片管理面板（预览、分页、单选/全选、批量删除）
- 支持通过命令面板或设置页快速打开图片管理
- 支持图片链接有效期设置（20年、50年、永久）与刷新有效期
- 支持测试连接，快速校验 COS 配置是否可用
- 支持公有读存储桶开关，适配公开图片与私有图片场景
- 支持存储桶地域选择与自定义存储路径前缀
- 支持图片格式（PNG、JPG、JPEG、GIF、SVG、WebP）

## 新手快速上手（3分钟）

1. 在腾讯云创建 COS 存储桶，并准备好 `SecretId` / `SecretKey`
2. 在 Obsidian 安装并启用插件
3. 在插件设置填写 `SecretId`、`SecretKey`、`Bucket`、`Region`
4. 点击“测试连接”确认配置可用
5. 在笔记中直接拖拽或粘贴图片，自动上传并替换为云端链接

## 使用前准备

1. 注册腾讯云账号并开通 COS 服务
   ![开通 COS 服务](./images/open-cos.png)
2. 创建存储桶，记录存储桶名称（Bucket）和所在地域（Region）
3. 获取 `SecretId` 和 `SecretKey`
4. 访问 [腾讯云控制台](https://console.cloud.tencent.cn/cos)
5. 进入「访问密钥」-> [API 密钥管理](https://console.cloud.tencent.com/cam/capi)

![获取密钥](./images/get-secret.png)

## 跨域访问 CORS 设置（注意）

> 复制到**来源 Origin** 的输入框内

```shell
app://obsidian.md
```

![跨域访问 CORS 设置1](./images/CORS-1.png)
![跨域访问 CORS 设置2](./images/CORS-2.png)

> ❗❗❗ **注意想在手机上使用需要把 `app://obsidian.md` 改成 `*`**

<details>
<summary>手机端安装方法(以 IOS 为例，安卓同理)</summary>

1. 打开 Obsidian 设置
2. 点击 Community plugins
3. 搜索 tencent
4. 安装并开启插件
5. 填写图床信息
6. 笔记上传图片

|  ![](./images/ios1.png){1}  |  ![](./images/ios2.png){2}  | ![](./images/ios3.png){3} |
| :-------------------------: | :-------------------------: | :-----------------------: |
|  ![](./images/ios4.png){4}  |  ![](./images/ios5.png){5}  | ![](./images/ios6.jpg){6} |
|  ![](./images/ios7.png){7}  |  ![](./images/ios8.jpg){8}  | ![](./images/ios9.jpg){9} |
| ![](./images/ios10.jpg){10} | ![](./images/ios11.jpg){11} |                           |

</details>

## 电脑端安装方法

1. 打开 Obsidian 设置
2. 进入 "第三方插件" -> "浏览"
3. 搜索 "Obsidian Imgur Plugin" 或者浏览器访问 [Obsidian Imgur Plugin](obsidian://show-plugin?id=imgur-tencent-cos)
4. 点击安装并启用插件

![启用插件](./images/active.png)

## 配置说明

1. 进入插件设置页面
2. 填写以下信息：
    - SecretId：腾讯云 API 密钥 ID
    - SecretKey：腾讯云 API 密钥 Key
    - Bucket：存储桶名称（例如：`my-bucket-1250000000`）
    - Region：存储桶所在地域
    - 存储路径前缀：文件在 COS 中的目录（例如：`images`）

> 存储路径前缀说明

比如你设置 `img`

![存储路径前缀说明1](./images/prefix-1.png)

那你的 COS 的图片就会上传到 `/img` 文件夹下

![存储路径前缀说明1](./images/prefix-2.png)

## 使用方法

### 方式一：拖拽上传

- 直接将图片文件拖拽到编辑器中
- 插件会自动上传图片并插入云端链接

### 方式二：复制粘贴

- 复制图片后，直接在编辑器中粘贴
- 插件会自动上传图片并插入云端链接

### 方式三：本地/线上笔记备份

1. 在插件设置中先配置备份路径（默认在当前仓库下，可自定义）
2. 按需选择备份方式并执行
3. 备份类型说明：
    - 本地笔记备份：适用于图片仍为本地链接、尚未上传/备份的笔记
    - 在线笔记备份：适用于图片已是线上链接、尚未备份的笔记
4. 执行后会按设置路径生成对应备份文件

### 方式四：图片管理

1. **通过命令面板**：
    - 按 `Ctrl+P`（Mac: `Cmd+P`）打开命令面板
    - 输入 "管理COS图片" 并选择该命令

2. **通过设置页面**：
    - 进入插件设置页面
    - 点击 "图片管理" 部分的 "打开图片管理" 按钮

3. **功能说明**：
    - 查看配置的存储路径下所有已上传的图片
    - 支持图片预览和基本信息显示（文件名、大小、上传时间）
    - 支持单选/全选图片
    - 支持批量删除选中的图片，删除前会弹出确认对话框
    - 支持分页加载，避免一次性加载过多图片
    - 删除操作会同步到COS，确保云端存储的一致性

## 操作预览

![操作预览](./images/preview.gif)

## 注意事项

1. 首次使用请确保已正确配置腾讯云 COS 相关信息
2. 上传前请确保网络连接正常
3. 建议定期检查存储桶用量，避免超出配额
4. 请妥善保管 SecretId 和 SecretKey，不要泄露给他人
5. 存储路径前缀**不要**以斜杠开头或结尾

## 支持与反馈

如果您在使用过程中遇到任何问题，或有功能建议，请通过以下方式反馈：

- 在 GitHub 上提交 Issue
- 发送邮件至：[15919854639@163.com]

## 打赏

<img src="./images/rewards.jpg" width='300' alt="打赏"/>

## 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

Copyright (c) 2024 bobostudio
